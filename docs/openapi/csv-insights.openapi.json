{
    "openapi": "3.0.0",
    "info": {
      "title": "CSV Insights API",
      "version": "1.0.0",
      "description": "Upload a CSV file and get high-level insights, key points, and optional column stats."
    },
    "paths": {
      "/ai-agent/v1/csv/insights": {
        "post": {
          "summary": "Analyze CSV and Generate Insights",
          "operationId": "analyzeCsvInsights",
          "requestBody": {
            "required": true,
            "content": {
              "multipart/form-data": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "file": {
                      "type": "string",
                      "format": "binary"
                    }
                  },
                  "required": ["file"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Successful CSV insights generation",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/CsvInsightsResponse"
                  },
                  "examples": {
                    "success": {
                      "summary": "Example response",
                      "value": {
                        "summary": "This dataset contains sales records by date, product, region, and revenue.",
                        "key_points": [
                          "Most sales occur in Q4 months.",
                          "Product A generates the highest total revenue.",
                          "Region West has the largest number of transactions but lower average revenue per sale."
                        ],
                        "column_stats": {
                          "date": {
                            "type": "date-like",
                            "notes": "Covers January to December 2024."
                          },
                          "product": {
                            "unique_values": 5,
                            "notes": "Product A appears most frequently."
                          },
                          "revenue": {
                            "numeric": true,
                            "approx_range": "100 - 5000",
                            "notes": "Revenue is right-skewed with a few large transactions."
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "400": {
              "description": "Bad Request (invalid or empty CSV)",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  },
                  "examples": {
                    "invalidFileType": {
                      "summary": "Not a CSV",
                      "value": {
                        "detail": "Only CSV files are supported."
                      }
                    },
                    "emptyCsv": {
                      "summary": "Empty CSV",
                      "value": {
                        "detail": "CSV file is empty."
                      }
                    }
                  }
                }
              }
            },
            "500": {
              "description": "Server or LLM error during CSV processing/insights generation",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  },
                  "examples": {
                    "readError": {
                      "summary": "Failed to read CSV",
                      "value": {
                        "detail": "Failed to read CSV: <details here>"
                      }
                    },
                    "llmError": {
                      "summary": "Model error",
                      "value": {
                        "detail": "CSV insights generation failed: <details here>"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "components": {
      "schemas": {
        "CsvInsightsResponse": {
          "type": "object",
          "properties": {
            "summary": {
              "type": "string",
              "description": "High-level description of what the dataset is about."
            },
            "key_points": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Important observations or insights from the data."
            },
            "column_stats": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": {}
              },
              "description": "Optional stats per column (e.g., uniqueness, numeric ranges, notes)."
            }
          },
          "required": ["summary"]
        },
        "ErrorResponse": {
          "type": "object",
          "properties": {
            "detail": {
              "type": "string"
            }
          },
          "required": ["detail"]
        }
      }
    }
  }
  