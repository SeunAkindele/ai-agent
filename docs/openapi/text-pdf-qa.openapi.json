{
    "openapi": "3.0.0",
    "info": {
      "title": "PDF Q&A API",
      "version": "1.0.0",
      "description": "Upload a PDF and ask questions about its content (Stage 1: in-memory store)."
    },
    "paths": {
      "/ai-agent/v1/pdf/upload": {
        "post": {
          "summary": "Upload PDF",
          "operationId": "uploadPdf",
          "requestBody": {
            "required": true,
            "content": {
              "multipart/form-data": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "file": {
                      "type": "string",
                      "format": "binary"
                    }
                  },
                  "required": ["file"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "PDF uploaded successfully",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/PdfUploadResponse"
                  },
                  "examples": {
                    "success": {
                      "summary": "Upload result",
                      "value": {
                        "doc_id": "7c4bcf09-b5b5-4a4b-9d3c-3dd0a43bd5b2",
                        "pages": 12
                      }
                    }
                  }
                }
              }
            },
            "400": {
              "description": "Invalid file or unreadable PDF",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  }
                }
              }
            },
            "500": {
              "description": "Server error while processing PDF",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  }
                }
              }
            }
          }
        }
      },
      "/ai-agent/v1/pdf/qa": {
        "post": {
          "summary": "Ask Question About PDF",
          "operationId": "askPdfQuestion",
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PdfQuestionRequest"
                },
                "examples": {
                  "example": {
                    "summary": "Ask a question",
                    "value": {
                      "doc_id": "7c4bcf09-b5b5-4a4b-9d3c-3dd0a43bd5b2",
                      "question": "What is the main conclusion of this document?"
                    }
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Answer from the PDF content",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/PdfQuestionResponse"
                  },
                  "examples": {
                    "success": {
                      "summary": "Example response",
                      "value": {
                        "answer": "The main conclusion is that FastAPI enables building high-performance APIs quickly using Python type hints.",
                        "used_pages": [2, 3],
                        "context_snippet": "FastAPI is a modern Python framework focused on speed and developer productivity..."
                      }
                    }
                  }
                }
              }
            },
            "400": {
              "description": "Bad request (e.g. empty question)",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  }
                }
              }
            },
            "404": {
              "description": "PDF not found in memory",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  }
                }
              }
            },
            "500": {
              "description": "Server or LLM error during QA",
              "content": {
                "application/json": {
                  "schema": {
                    "$ref": "#/components/schemas/ErrorResponse"
                  }
                }
              }
            }
          }
        }
      }
    },
    "components": {
      "schemas": {
        "PdfUploadResponse": {
          "type": "object",
          "properties": {
            "doc_id": {
              "type": "string"
            },
            "pages": {
              "type": "integer"
            }
          },
          "required": ["doc_id", "pages"]
        },
        "PdfQuestionRequest": {
          "type": "object",
          "properties": {
            "doc_id": {
              "type": "string"
            },
            "question": {
              "type": "string"
            }
          },
          "required": ["doc_id", "question"]
        },
        "PdfQuestionResponse": {
          "type": "object",
          "properties": {
            "answer": {
              "type": "string"
            },
            "used_pages": {
              "type": "array",
              "items": {
                "type": "integer"
              }
            },
            "context_snippet": {
              "type": "string",
              "nullable": true
            }
          },
          "required": ["answer"]
        },
        "ErrorResponse": {
          "type": "object",
          "properties": {
            "detail": {
              "type": "string"
            }
          },
          "required": ["detail"]
        }
      }
    }
  }
  